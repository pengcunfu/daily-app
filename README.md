# DailyApp - å½¢è±¡ç®¡ç†ç³»ç»Ÿ

ä¸€ä¸ªå®Œæ•´çš„å½¢è±¡ç®¡ç†åº”ç”¨ï¼ŒåŒ…å«ç§»åŠ¨ç«¯Appã€Webç®¡ç†åå°å’Œåç«¯APIæœåŠ¡ã€‚

## ğŸ—ï¸ é¡¹ç›®æ¶æ„

```
DailyApp/
â”œâ”€â”€ daily-app/          # ç§»åŠ¨ç«¯åº”ç”¨ (uni-app)
â”œâ”€â”€ daily-server/       # åç«¯APIæœåŠ¡ (Koa2 + Prisma + MySQL)
â”œâ”€â”€ daily-web/          # Webç®¡ç†åå° (Vue3 + Element Plus)
â”œâ”€â”€ bak/               # å¤‡ä»½æ–‡ä»¶å¤¹
â”œâ”€â”€ docker-compose.yml  # Dockerç¼–æ’æ–‡ä»¶
â””â”€â”€ README.md          # é¡¹ç›®è¯´æ˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js 18+
- MySQL 8.0+
- Docker & Docker Compose (å¯é€‰)

### æ–¹å¼ä¸€ï¼šDocker éƒ¨ç½² (æ¨è)

1. **å…‹éš†é¡¹ç›®**
```bash
git clone <repository-url>
cd DailyApp
```

2. **å¯åŠ¨æ‰€æœ‰æœåŠ¡**
```bash
docker-compose up -d
```

3. **è®¿é—®åº”ç”¨**
- Webç®¡ç†åå°: http://localhost:5173
- APIæœåŠ¡: http://localhost:3000
- æ•°æ®åº“: localhost:3306

### æ–¹å¼äºŒï¼šæœ¬åœ°å¼€å‘

#### 1. å¯åŠ¨æ•°æ®åº“

```bash
# ä½¿ç”¨ Docker å¯åŠ¨ MySQL
docker run -d \
  --name dailyapp-mysql \
  -e MYSQL_ROOT_PASSWORD=rootpassword \
  -e MYSQL_DATABASE=dailyapp \
  -e MYSQL_USER=dailyapp \
  -e MYSQL_PASSWORD=dailyapp123 \
  -p 3306:3306 \
  mysql:8.0
```

#### 2. å¯åŠ¨åç«¯æœåŠ¡

```bash
cd daily-server

# å®‰è£…ä¾èµ–
npm install

# é…ç½®ç¯å¢ƒå˜é‡
cp config.template .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œè®¾ç½®æ•°æ®åº“è¿æ¥ç­‰é…ç½®

# è¿è¡Œæ•°æ®åº“è¿ç§»
npm run migrate

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

#### 3. å¯åŠ¨Webç®¡ç†åå°

```bash
cd daily-web

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

#### 4. ç§»åŠ¨ç«¯å¼€å‘

```bash
cd daily-app

# å®‰è£…ä¾èµ–
npm install

# H5å¼€å‘
npm run dev:h5

# å°ç¨‹åºå¼€å‘
npm run dev:mp-weixin

# Appå¼€å‘
npm run dev:app
```

## ğŸ“± åŠŸèƒ½ç‰¹æ€§

### ç§»åŠ¨ç«¯ App (daily-app)
- **å½¢è±¡è®°å½•** - æ¯æ—¥è‡ªæ‹ç…§ç‰‡ä¸Šä¼ 
- **æœ¬åœ°å­˜å‚¨** - æœªç™»å½•æ—¶ä½¿ç”¨æœ¬åœ°å­˜å‚¨
- **æ•°æ®åŒæ­¥** - ç™»å½•åä¸æœåŠ¡å™¨åŒæ­¥æ•°æ®
- **è·¨å¹³å°** - æ”¯æŒ H5ã€å°ç¨‹åºã€iOSã€Android

### Webç®¡ç†åå° (daily-web)
- **ç”¨æˆ·ç®¡ç†** - æŸ¥çœ‹å’Œç®¡ç†æ‰€æœ‰ç”¨æˆ·
- **å½¢è±¡ç®¡ç†** - æµè§ˆã€ç¼–è¾‘ã€åˆ é™¤å½¢è±¡è®°å½•
- **æ•°æ®ç»Ÿè®¡** - å„ç§å›¾è¡¨å’Œç»Ÿè®¡ä¿¡æ¯
- **ç³»ç»Ÿè®¾ç½®** - åŸºç¡€é…ç½®ç®¡ç†

### åç«¯API (daily-server)
- **RESTful API** - æ ‡å‡†çš„RESTæ¥å£
- **JWTè®¤è¯** - å®‰å…¨çš„ç”¨æˆ·è®¤è¯
- **æ–‡ä»¶ä¸Šä¼ ** - å›¾ç‰‡ä¸Šä¼ å’Œå¤„ç†
- **æ•°æ®åŒæ­¥** - æ”¯æŒå¤šè®¾å¤‡æ•°æ®åŒæ­¥
- **MySQLå­˜å‚¨** - å¯é çš„æ•°æ®æŒä¹…åŒ–

## ğŸ”§ æŠ€æœ¯æ ˆ

### ç§»åŠ¨ç«¯
- **uni-app** - è·¨å¹³å°å¼€å‘æ¡†æ¶
- **Vue 3** - æ¸è¿›å¼JavaScriptæ¡†æ¶
- **Vite** - å¿«é€Ÿæ„å»ºå·¥å…·

### Webç«¯
- **Vue 3** - ä½¿ç”¨Composition API
- **Element Plus** - UIç»„ä»¶åº“
- **Pinia** - çŠ¶æ€ç®¡ç†
- **ECharts** - æ•°æ®å¯è§†åŒ–
- **Vite** - æ„å»ºå·¥å…·

### åç«¯
- **Koa2** - Node.js Webæ¡†æ¶
- **Prisma** - ç°ä»£åŒ–ORM
- **MySQL 8.0** - å…³ç³»å‹æ•°æ®åº“
- **JWT** - èº«ä»½è®¤è¯
- **Sharp** - å›¾ç‰‡å¤„ç†

## ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡

### ä¸»è¦æ•°æ®è¡¨
- `users` - ç”¨æˆ·è¡¨
- `appearances` - å½¢è±¡è®°å½•è¡¨
- `user_devices` - ç”¨æˆ·è®¾å¤‡è¡¨
- `sync_logs` - åŒæ­¥æ—¥å¿—è¡¨

è¯¦ç»†çš„æ•°æ®åº“ç»“æ„è¯·æŸ¥çœ‹ `daily-server/prisma/schema.prisma`

## ğŸ” å®‰å…¨ç‰¹æ€§

- **JWTè®¤è¯** - å®‰å…¨çš„ç”¨æˆ·èº«ä»½éªŒè¯
- **å¯†ç åŠ å¯†** - bcryptåŠ å¯†å­˜å‚¨
- **CORSé…ç½®** - è·¨åŸŸè¯·æ±‚æ§åˆ¶
- **æ–‡ä»¶éªŒè¯** - ä¸Šä¼ æ–‡ä»¶ç±»å‹å’Œå¤§å°é™åˆ¶
- **SQLæ³¨å…¥é˜²æŠ¤** - Prisma ORMé˜²æŠ¤
- **XSSé˜²æŠ¤** - è¾“å…¥è¾“å‡ºè¿‡æ»¤

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

- **Winstonæ—¥å¿—** - ç»“æ„åŒ–æ—¥å¿—è®°å½•
- **å¥åº·æ£€æŸ¥** - APIå¥åº·çŠ¶æ€ç›‘æ§
- **é”™è¯¯è¿½è¸ª** - è¯¦ç»†çš„é”™è¯¯æ—¥å¿—
- **æ€§èƒ½ç›‘æ§** - è¯·æ±‚å“åº”æ—¶é—´ç»Ÿè®¡

## ğŸš€ éƒ¨ç½²è¯´æ˜

### Dockeréƒ¨ç½²

```bash
# æ„å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# åœæ­¢æœåŠ¡
docker-compose down
```

### ç”Ÿäº§ç¯å¢ƒé…ç½®

1. **ç¯å¢ƒå˜é‡é…ç½®**
   - ä¿®æ”¹ `daily-server/.env` ä¸­çš„ç”Ÿäº§ç¯å¢ƒé…ç½®
   - è®¾ç½®å¼ºå¯†ç å’Œå®‰å…¨çš„JWTå¯†é’¥

2. **SSLè¯ä¹¦**
   - é…ç½®HTTPSè¯ä¹¦
   - æ›´æ–°nginxé…ç½®

3. **æ•°æ®åº“ä¼˜åŒ–**
   - é…ç½®MySQLæ€§èƒ½å‚æ•°
   - è®¾ç½®å®šæœŸå¤‡ä»½

## ğŸ“ APIæ–‡æ¡£

### è®¤è¯æ¥å£
- `POST /api/auth/login` - ç”¨æˆ·ç™»å½•
- `POST /api/auth/register` - ç”¨æˆ·æ³¨å†Œ
- `POST /api/auth/refresh` - åˆ·æ–°token

### å½¢è±¡ç®¡ç†æ¥å£
- `GET /api/appearances` - è·å–å½¢è±¡è®°å½•åˆ—è¡¨
- `POST /api/appearances` - åˆ›å»ºå½¢è±¡è®°å½•
- `PUT /api/appearances/:id` - æ›´æ–°å½¢è±¡è®°å½•
- `DELETE /api/appearances/:id` - åˆ é™¤å½¢è±¡è®°å½•

### æ–‡ä»¶ä¸Šä¼ æ¥å£
- `POST /api/upload/appearance` - ä¸Šä¼ å½¢è±¡ç…§ç‰‡
- `POST /api/upload/avatar` - ä¸Šä¼ å¤´åƒ

è¯¦ç»†çš„APIæ–‡æ¡£è¯·æŸ¥çœ‹å„é¡¹ç›®çš„READMEæ–‡ä»¶ã€‚

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- æäº¤ Issue
- å‘é€é‚®ä»¶
- å¾®ä¿¡ç¾¤è®¨è®º

---

â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™å®ƒä¸€ä¸ªæ˜Ÿæ ‡ï¼